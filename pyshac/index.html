



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Documentation for PySHAC, the Python library for Sequential Halving and Classification.">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="./assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.1">
    
    
      
        <title>PySHAC Documentation</title>
      
    
    
      <link rel="stylesheet" href="./assets/stylesheets/application.ba0fd1a6.css">
      
        <link rel="stylesheet" href="./assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
      <script src="./assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="./assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="light-blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pyshac-python-sequential-halving-and-classification" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="PySHAC Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                PySHAC Documentation
              </span>
              <span class="md-header-nav__topic">
                Home
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/titu1994/pyshac/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Github
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    PySHAC Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/titu1994/pyshac/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Github
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Home
      </label>
    
    <a href="." title="Home" class="md-nav__link md-nav__link--active">
      Home
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" title="Documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-pyshac" title="Getting started with PySHAC" class="md-nav__link">
    Getting started with PySHAC
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-build-the-set-of-hyper-parameters-the-three-main-hyperparameter-classes-are" title="First, build the set of hyper parameters. The three main HyperParameter classes are :" class="md-nav__link">
    First, build the set of hyper parameters. The three main HyperParameter classes are :
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-the-engine" title="Setup the engine" class="md-nav__link">
    Setup the engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-the-classifiers" title="Training the classifiers" class="md-nav__link">
    Training the classifiers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-the-best-hyper-parameters" title="Sampling the best hyper parameters" class="md-nav__link">
    Sampling the best hyper parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="install/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="guide/" title="User Guide" class="md-nav__link">
      User Guide
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="serial-execution/" title="Serial Evaluation" class="md-nav__link">
      Serial Evaluation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="managed/" title="Managed Engines" class="md-nav__link">
      Managed Engines
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="custom-hyper-parameters/" title="Custom Hyper Parameters" class="md-nav__link">
      Custom Hyper Parameters
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Config
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Config
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="config/hyperparameters/" title="Hyper Parameters" class="md-nav__link">
      Hyper Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="config/data/" title="Datasets" class="md-nav__link">
      Datasets
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Core
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="core/engine/" title="SHAC" class="md-nav__link">
      SHAC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="core/torch_engine/" title="PyTorch SHAC" class="md-nav__link">
      PyTorch SHAC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="core/tf_engine/" title="Tensorflow SHAC" class="md-nav__link">
      Tensorflow SHAC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="core/keras_engine/" title="Keras SHAC" class="md-nav__link">
      Keras SHAC
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installation" title="Installation" class="md-nav__link">
    Installation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documentation" title="Documentation" class="md-nav__link">
    Documentation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started-with-pyshac" title="Getting started with PySHAC" class="md-nav__link">
    Getting started with PySHAC
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#first-build-the-set-of-hyper-parameters-the-three-main-hyperparameter-classes-are" title="First, build the set of hyper parameters. The three main HyperParameter classes are :" class="md-nav__link">
    First, build the set of hyper parameters. The three main HyperParameter classes are :
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup-the-engine" title="Setup the engine" class="md-nav__link">
    Setup the engine
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-the-classifiers" title="Training the classifiers" class="md-nav__link">
    Training the classifiers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-the-best-hyper-parameters" title="Sampling the best hyper parameters" class="md-nav__link">
    Sampling the best hyper parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" title="Examples" class="md-nav__link">
    Examples
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/titu1994/pyshac/edit/master/docs/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="pyshac-python-sequential-halving-and-classification">PySHAC : Python Sequential Halving and Classification<a class="headerlink" href="#pyshac-python-sequential-halving-and-classification" title="Permanent link">&para;</a></h1>
<p>PySHAC is a python library to use the Sequential Halving and Classification algorithm from the paper
<a href="https://arxiv.org/abs/1805.10255">Parallel Architecture and Hyperparameter Search via Successive Halving and Classification</a> with ease.</p>
<p>Note : This library is not affiliated with Google.</p>
<hr />
<h2 id="installation">Installation<a class="headerlink" href="#installation" title="Permanent link">&para;</a></h2>
<p>This library is available for Python 2.7 and 3.4+ via pip for Windows, MacOSX and Linux.</p>
<div class="codehilite"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyshac</span>
</pre></div>

<p>To install the master branch of this library :</p>
<div class="codehilite"><pre><span></span>git clone https://github.com/titu1994/pyshac.git
cd pyshac
python setup.py install
</pre></div>

<p>To install the requirements before installing the library :</p>
<div class="codehilite"><pre><span></span>pip install -r &quot;requirements.txt&quot;
</pre></div>

<p>To build the docs, additional packages must be installed :
<div class="codehilite"><pre><span></span>pip install -r &quot;doc_requirements.txt&quot;
</pre></div></p>
<h2 id="documentation">Documentation<a class="headerlink" href="#documentation" title="Permanent link">&para;</a></h2>
<p>Stable build documentation can be found at <a href="http://titu1994.github.io/pyshac/">PySHAC Documentation</a>.</p>
<p>It contains a User Guide, as well as explanation of the different engines that can be used with PySHAC.</p>
<h2 id="getting-started-with-pyshac">Getting started with PySHAC<a class="headerlink" href="#getting-started-with-pyshac" title="Permanent link">&para;</a></h2>
<h3 id="first-build-the-set-of-hyper-parameters-the-three-main-hyperparameter-classes-are">First, build the set of hyper parameters. The three main HyperParameter classes are :<a class="headerlink" href="#first-build-the-set-of-hyper-parameters-the-three-main-hyperparameter-classes-are" title="Permanent link">&para;</a></h3>
<ul>
<li>DiscreteHyperParameter</li>
<li>UniformContinuousHyperParameter</li>
<li>NormalContinuousHyperParameter</li>
</ul>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">pyshac</span>

<span class="c1"># Discrete parameters</span>
<span class="n">dice_rolls</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">DiscreteHyperParameter</span><span class="p">(</span><span class="s1">&#39;dice&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">coin_flip</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">DiscreteHyperParameter</span><span class="p">(</span><span class="s1">&#39;coin&#39;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Continuous Parameters</span>
<span class="n">classifier_threshold</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">UniformContinuousHyperParameter</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">,</span> <span class="n">min_value</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">max_value</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">NormalContinuousHyperParameter</span><span class="p">(</span><span class="s1">&#39;noise&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>

<h3 id="setup-the-engine">Setup the engine<a class="headerlink" href="#setup-the-engine" title="Permanent link">&para;</a></h3>
<p>When setting up the SHAC engine, we need to define a few important parameters which will be used by the engine :</p>
<ul>
<li><strong>Hyper Parameter list</strong>: A list of parameters that have been declared. This will constitute the search space.</li>
<li><strong>Total budget</strong>: The number of evaluations that will occur.</li>
<li><strong>Number of batches</strong>: The number of samples per batch of evaluation.</li>
<li><strong>Objective</strong>: String value which can be either <code>max</code> or <code>min</code>. Defines whether the objective should be maximised or minimised.</li>
<li><strong>Maximum number of classifiers</strong>: As it suggests, decides the upper limit of how many classifiers can be trained. This is optional, and usually not required to specify.</li>
</ul>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pyshac</span>

<span class="c1"># define the parameters</span>
<span class="n">param_x</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">UniformContinuousHyperParameter</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
<span class="n">param_y</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">UniformContinuousHyperParameter</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">param_x</span><span class="p">,</span> <span class="n">param_y</span><span class="p">]</span>

<span class="c1"># define the total budget as 100 evaluations</span>
<span class="n">total_budget</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100 evaluations at maximum</span>

<span class="c1"># define the number of batches</span>
<span class="n">num_batches</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># 10 samples per batch</span>

<span class="c1"># define the objective</span>
<span class="n">objective</span> <span class="o">=</span> <span class="s1">&#39;min&#39;</span>  <span class="c1"># minimize the squared loss</span>

<span class="n">shac</span> <span class="o">=</span> <span class="n">pyshac</span><span class="o">.</span><span class="n">SHAC</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">total_budget</span><span class="p">,</span> <span class="n">num_batches</span><span class="p">,</span> <span class="n">objective</span><span class="p">)</span>
</pre></div>

<h3 id="training-the-classifiers">Training the classifiers<a class="headerlink" href="#training-the-classifiers" title="Permanent link">&para;</a></h3>
<p>To train a classifier, the user must define an Evaluation function. This is a user defined function,
that accepts 2 or more inputs as defined by the engine, and returns a python floating point value.</p>
<p>The <strong>Evaluation Function</strong> receives at least 2 inputs :</p>
<ul>
<li><strong>Worker ID</strong>: Integer id that can be left alone when executing only on CPU or used to determine the iteration number in the current epoch of evaluation.</li>
<li><strong>Parameter OrderedDict</strong>: An OrderedDict which contains the (name, value) pairs of the Parameters passed to the engine.<ul>
<li>Since it is an ordered dict, if only the values are required, <code>list(parameters.values())</code> can be used to get the list of values in the same order as when the Parameters were declared to the engine.</li>
<li>These are the values of the sampled hyper parameters which have passed through the current cascade of models.</li>
</ul>
</li>
</ul>
<p>An example of a defined evaluation function :</p>
<div class="codehilite"><pre><span></span><span class="c1"># define the evaluation function</span>
<span class="k">def</span> <span class="nf">squared_error_loss</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
    <span class="n">y_sample</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>

    <span class="c1"># assume best values of x and y and 2 and 0 respectively</span>
    <span class="n">y_true</span> <span class="o">=</span> <span class="mf">4.</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y_sample</span> <span class="o">-</span> <span class="n">y_true</span><span class="p">)</span>
</pre></div>

<p>A single call to <code>shac.fit()</code> will begin training the classifiers.</p>
<p>There are a few cases to consider:</p>
<ul>
<li>There can be cases where the search space is not large enough to train the maximum number of classifier (usually 18).</li>
<li>There may be instances where we want to allow some relaxations of the constraint that the next batch must pass through all
of the previous classifiers. This allows classifiers to train on the same search space repeatedly rather than divide the search space.</li>
</ul>
<p>In these cases, we can utilize a few additional parameters to allow the training behaviour to better adapt to these circumstances.
These parameters are :</p>
<ul>
<li><strong>skip_cv_checks</strong>: As it suggests, if the number of samples per batch is too small, it is preferable to skip the cross validation check, as most classifiers will not pass them.</li>
<li><strong>early_stop</strong>: Determines whether training should halt as soon as an epoch of failed learning occurs. This is useful when evaluations are very costly.</li>
<li><strong>relax_checks</strong>: This will instead relax the constrain of having the sample pass through all classifiers to having the classifier past through most of the classifiers. In doing so, more samples can be obtained for the same search space.</li>
</ul>
<div class="codehilite"><pre><span></span><span class="c1"># `early stopping` default is False, and it is preferred not to use it when using `relax checks`</span>
<span class="n">shac</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">squared_error_loss</span><span class="p">,</span> <span class="n">skip_cv_checks</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">early_stop</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">relax_checks</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

<h2 id="sampling-the-best-hyper-parameters">Sampling the best hyper parameters<a class="headerlink" href="#sampling-the-best-hyper-parameters" title="Permanent link">&para;</a></h2>
<p>Once the models have been trained by the engine, it is as simple as calling <code>predict()</code> to sample multiple samples or batches of parameters.</p>
<p>Samples can be obtained in a per instance or per batch (or even a combination) using the two parameters - <code>num_samples</code> and <code>num_batches</code>.</p>
<div class="codehilite"><pre><span></span><span class="c1"># sample a single instance of hyper parameters</span>
<span class="n">parameter_samples</span> <span class="o">=</span> <span class="n">shac</span><span class="o">.</span><span class="n">predict</span><span class="p">()</span>  <span class="c1"># samples 1 sample.</span>

<span class="c1"># sample multiple instances of hyper parameters</span>
<span class="n">parameter_samples</span> <span class="o">=</span> <span class="n">shac</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># samples 10 samples.</span>

<span class="c1"># sample a batch of hyper parameters</span>
<span class="n">parameter_samples</span> <span class="o">=</span> <span class="n">shac</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">num_batches</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># samples 5 batches, each containing 10 samples.</span>

<span class="c1"># sample multiple batches and a few additional instances of hyper parameters</span>
<span class="n">parameter_samples</span> <span class="o">=</span> <span class="n">shac</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># samples 5 batches (each containing 10 samples) and an additional 5 samples.</span>
</pre></div>

<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p>Examples based on the <code>Branin</code> and <code>Hartmann6</code> problems can be found in the <a href="https://github.com/titu1994/pyshac/tree/master/examples">Examples folder</a>.</p>
<p>An example of how to use the <code>TensorflowSHAC</code> engine is provided <a href="https://github.com/titu1994/pyshac/tree/master/examples/tensorflow">in the example foldes as well</a>.</p>
<p>Comparison scripts of basic optimization, <code>Branin</code> and <code>Hartmann6</code> using Tensorflow Eager 1.8 are provided in the respective folders.</p>
<hr />
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="install/" title="Installation" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Installation
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="./assets/javascripts/application.a59e2a89.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:"."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-47921241-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>